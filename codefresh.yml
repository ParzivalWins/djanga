version: '1.0'

steps:
  
  unit-test:
    image: tutum/curl
    commands: 
      - >-
        curl -X POST -H 'Content-type: application/json' --data "{\"text\": \"-----------------\"}"  https://hooks.slack.com/services/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
      - >-
        curl -X POST -H 'Content-type: application/json' --data "{\"text\": \"$MESSAGE\"}"  https://hooks.slack.com/services/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
    environment:
      - JIM=JIM
      - PORT=9000
    fail-fast: false
      
  build-djanga:
    type: build
    description: It builds the Djanga Service
    dockerfile: Dockerfile
    image-name: noamt/djanga
    tag: jimbob
  
  test-comp:
    type: composition
    description: It composes the Djanga Service
    composition: dja
    composition-candidates:
      - db:
          image: postgres
    composition-variables:
      - key=value

  push-dockerhub:
    type: push
    candidate: ${{build-djanga}}
    tag: awesomeness
    credentials:
      username: ${{username}}
      password: ${{password}}
