version: '1.0'

steps:
  #clone-jim:
  #  type: git-clone
  #  revision: cfeb549e834714c0447658a8b539a102814a1823
  #  repo: https://github.com/noamt/djanga.git

  unit-test-jim:
    image: alpine:latest
    commands: 
      - ls -l
      - touch jimbob.txt
      - echo "jimbob" > jimbob.txt
    environment:
      - JIM=BOB
      - PORT=9000

  integration-tests:
    type: composition
    image: alpine
    working-directory: ${{clone-jim}}
    composition-file: integ-test-composition.yml
    commands:
      - tests/exec.sh

  build-jim:
    type: build
    description: It builds the Jim Service
    dockerfile: Dockerfile
    image-name: noamt/djanga
    tag: nicetag
    #build-arguments:
    #  - PORT=9000

  #build-bob:
  #  type: build
  #  description: It builds the Jim Service
  #  dockerfile: Dockerfile
  #  image-name: blamco/jimbob
  #  tag: developpp
  #  working-directory: ${{unit-test-jim}}

  push-dockerhub:
    type: push
    candidate: ${{build-jim}}
    tag: thanksmuch
